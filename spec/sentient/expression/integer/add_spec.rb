require "spec_helper"

RSpec.describe Sentient::Expression::Integer::Add do
  it "" do
    expression = described_class.new(
      Sentient::Expression::Integer::Literal.new(0),
      Sentient::Expression::Integer::Literal.new(0)
    )

    expect(expression.to_dimacs).to eq [
      # 0
      ["-1"],
      ["-2"],

      # 0
      ["-3"],
      ["-4"],

      # 5 := xor bit 1
      ["-1", "-3", "-5"],
      ["1", "3", "-5"],
      ["1", "-3", "5"],
      ["-1", "3", "5"],

      # false
      ["-6"],

      # 7 := sum bit 1         <--- bit 1 output
      ["-5", "-6", "-7"],
      ["5", "6", "-7"],
      ["5", "-6", "7"],
      ["-5", "6", "7"],

      # 8 := xor bit 2
      ["-2", "-4", "-8"],
      ["2", "4", "-8"],
      ["2", "-4", "8"],
      ["-2", "4", "8"],

      # 9 := and bit 1
      ["-1", "-3", "9"],
      ["1", "-9"],
      ["3", "-9"],

      # 10 := xor bit 1
      ["-1", "-3", "-10"],
      ["1", "3", "-10"],
      ["1", "-3", "10"],
      ["-1", "3", "10"],

      # 11 := and carry with xor bit 1
      ["-6", "-10", "11"],
      ["6", "-11"],
      ["10", "-11"],

      # 12 := carry bit 1
      ["9", "11", "-12"],
      ["-9", "12"],
      ["-11", "12"],

      # 13 := sum bit 2          <-- bit 2 output
      ["-8", "-12", "-13"],
      ["8", "12", "-13"],
      ["8", "-12", "13"],
      ["-8", "12", "13"],

      # 14 := and bit 2
      ["-2", "-4", "14"],
      ["2", "-14"],
      ["4", "-14"],

      # 15 := xor bit 2
      ["-2", "-4", "-15"],
      ["2", "4", "-15"],
      ["2", "-4", "15"],
      ["-2", "4", "15"],

      # 16 := and carry with xor bit 2
      ["-12", "-15", "16"],
      ["12", "-16"],
      ["15", "-16"],

      # 16 := carry bit 2        <-- bit 3 output
      ["14", "16", "-17"],
      ["-14", "17"],
      ["-16", "17"]
    ]
    expect(expression.integer).to eq ["7", "13", "17"]
  end
end
